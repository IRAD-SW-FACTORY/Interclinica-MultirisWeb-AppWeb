var scripts=document.getElementsByTagName("script"),thisScript=scripts[scripts.length-1],path=thisScript.src.substring(0,thisScript.src.lastIndexOf("/"))+"/",INVOX,Invox;INVOX=Invox=function(){function n(n,o,e,t,i,r,s,a,d,u){window.targets||(window.targets=[]),window.targets[n]={id:n,target:o,user:e,password:t,host:i,port:r,text:s,format:a,agent:d,secure:u}}function o(n){var o=CKEDITOR.instances[n];return o||(window.console.log('[error]: GetEditor: The editor with id "'+n+'" did not exist when Invox.GetEditor was called, returning first editor'),t())}function e(n,o){"ready"==n.status?o():setTimeout(function(){e(n,o)},100)}function t(){var n=null;for(var o in CKEDITOR.instances){n=CKEDITOR.instances[o];break}return n}function i(n,t){var i=o(n);t=t||n,e(i,function(){i.insertText(t)})}function r(n,t){var i=o(n);t=t||n,e(i,function(){i.insertHtml(t)})}function s(){return"http:"===location.protocol}function a(){var n=location.host;return"localhost"===n||"127.0.0.1"===n}function d(){if(s()&&!a()){var n=alert;"undefined"!=typeof toastr&&(n=function(n){return optionsOverride={tapToDismiss:!1,showDuration:0,timeOut:0,extendedTimeOut:0},toastr.error(n,"",optionsOverride)}),n("El navegador no permite el acceso de audio en protocolos no seguros como http://")}}return{ShowLocalSampleError:function(){var n=alert;"undefined"!=typeof toastr&&(n=function(n){return optionsOverride={tapToDismiss:!1,showDuration:0,timeOut:0,extendedTimeOut:0},toastr.error(n,"",optionsOverride)}),n("Este ejemplo no funciona correctamente desde una ruta local, despliéguelo en un servidor.")},SendTextTo:function(n,e){o(n);e=e||n;var t={EditorName:n,Text:Invox.GetText(n),FormattedText:Invox.GetFormattedText(n)},i=JSON.stringify(t),r=0,s=function(){window.close(),toastr.warning("No se ha podido cerrar esta ventana automáticamente")},a=function(n){r+=1,r<3?setTimeout(d,300):(toastr.error("No se ha podido comprobar que el texto ha sido recibido satisfactoriamente."),window.console.log("[error]: ERROR al enviar el texto a "+e),window.console.log(n))},d=function(){try{if("XDomainRequest"in window&&null!==window.XDomainRequest){var n=new XDomainRequest;n.open("POST",e),n.onload=s,n.onerror=a,n.send(i)}else jQuery.support.cors=!0,jQuery.ajax({type:"POST",url:e,contentType:"application/json; charset=utf-8",data:i}).fail(a).done(s)}catch(n){a(n)}};d()},AddGrammar:function(n,o){AddCustomCommandRunning(n,o)},AddCustomCommandRunning:function(n,o){invoxmdWE.CustomCommandsRunning[n]=o},RemoveCustomCommandRunning:function(n){invoxmdWE.CustomCommandsRunning[n]=null},RemoveAllCustomCommandsRunning:function(){invoxmdWE.CustomCommandsRunning=[]},GetCustomCommandsRunning:function(){var n=[];for(var o in invoxmdWE.CustomCommandsRunning)invoxmdWE.CustomCommandsRunning.hasOwnProperty(o)&&n.push(o);return n},AddCustomCommandPaused:function(n,o){invoxmdWE.CustomCommandsPaused[n]=o},RemoveCustomCommandPaused:function(n){invoxmdWE.CustomCommandsPaused[n]=null},RemoveAllCustomCommandsPaused:function(){invoxmdWE.CustomCommandsPaused=[]},GetCustomCommandsPaused:function(){var n=[];for(var o in invoxmdWE.CustomCommandsPaused)invoxmdWE.CustomCommandsPaused.hasOwnProperty(o)&&n.push(o);return n},GetEditor:function(n){return o(n)},AppendHTML:function(n,o){r(n,o)},AppendText:function(n,o){i(n,o)},GetAgentVersion:function(){return!imdSession||imdSession&&!imdSession.User?(window.console.log("[error]: GetAgentVersion: The session has not been established"),""):imdSession.UseAgent&&"0.0.0.0"!==imdSession.AgentVersion?(imdSession.AgentVersion?imdSession.AgentVersion:"LITE")+("0.0.0.0"!==imdSession.SWSVersion?" REMOTE":" LOCAL"):""},LearnNewWords:function(n){return!imdSession||imdSession&&!imdSession.User?(window.console.log("[error]: LearnNewWords: The session has not been established"),null):(imdSession.Recognizer.learnNewWords(n),null)},GetText:function(n){var e=o(n);if(e){var t=ckeditorTextHelper.getAllText(e);return t=invoxmd.Formatter.CleanText(t)}return window.console.log('[error]: The editor with id "'+n+'" did not exist when Invox.GetText was called.'),null},GetFormattedText:function(n){var e=o(n);if(e){var t=e.getData();return t=invoxmd.Formatter.CleanText(t)}return window.console.log('[error]: The editor with id "'+n+'" did not exist when Invox.GetFormattedText was called.'),null},Internal:function(o,e,t,i,r,s,a){CKEDITOR.timestamp=invoxmd.commit;for(var u,m=0;m<o.length;m++){var l=o[m],c="string"==typeof l?l:l.id,f="string"==typeof l?l:l.config;if(document.getElementById(c)){s||d();var u=CKEDITOR.replace(c,f);u.isInternal=!0,u.urlToExport=a||void 0}else window.console.log('[error]: Container id "'+c+'" did not exist in HTML Code when Invox.Internal was called.')}n("DEFAULT",null,e,t,i,r,"","unformatted",s,!s||s&&8443==r),window.idTarget="DEFAULT"},External:function(o,e,t,i,r,s,a){var d=document.getElementById(o);if(null==d)return void window.console.log('[error]: Container id "'+o+'" did not exist in HTML Code when Invox.External was called,');var u=!a||a&&8444==s;n(o,d,t,i,r,s,"formatted"==e?d.innerHTML:d.value,e,a,u),window.open(path+"invoxMDEditor.html",o).idTarget=o}}}();